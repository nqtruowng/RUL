# Khai báo các thành phần
a1.sources = r1
a1.sinks = k1
a1.channels = c1

# 1. Source: Netcat (Lắng nghe tại port 44444)
a1.sources.r1.type = netcat
a1.sources.r1.bind = 0.0.0.0
a1.sources.r1.port = 44444

# 2. Sink: HDFS (Ghi trực tiếp vào cụm Hadoop)
a1.sinks.k1.type = hdfs
a1.sinks.k1.hdfs.path = hdfs://namenode:9000/user/flume/stream
a1.sinks.k1.hdfs.filePrefix = sensor-log
a1.sinks.k1.hdfs.fileType = DataStream
a1.sinks.k1.hdfs.writeFormat = Text

# 3. Channel: Memory
a1.channels.c1.type = memory
a1.channels.c1.capacity = 1000
a1.channels.c1.transactionCapacity = 100

# 4. Liên kết (Bind)
a1.sources.r1.channels = c1
a1.sinks.k1.channel = c1

a1.sinks.k1.hdfs.batchSize = 1

# Cứ 30 giây sẽ tạo ra 1 file mới trên HDFS để bạn nhìn thấy kết quả ngay
a1.sinks.k1.hdfs.rollInterval = 30

# 3. Kích thước file (Set = 0 để tắt, dùng thời gian làm chuẩn)
a1.sinks.k1.hdfs.rollSize = 0

# 4. Số lượng dòng tối đa trong 1 file (Set = 0 để tắt)
a1.sinks.k1.hdfs.rollCount = 0

# 5. Nếu không có dữ liệu, sau bao lâu thì đóng file?
a1.sinks.k1.hdfs.idleTimeout = 10
a1.sinks.k1.hdfs.useLocalTimeStamp = true